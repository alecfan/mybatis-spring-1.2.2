<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!--  AutoGenerated by lindzh  2015年11月18日 12:15 -->
<mapper namespace="org.mybatis.spring.cache.dao.PartnerInfoDao">

	<resultMap id="PartnerInfoResultMap" type="org.mybatis.spring.cache.pojo.PartnerInfo">
		<id property="id" column="id"/>
		<result property="title" column="title"/>
		<result property="jieshao" column="jieshao"/>
		<result property="shijian" column="shijian"/>
		<result property="shijian_begin" column="shijian_begin"/>
		<result property="shijian_end" column="shijian_end"/>
		<result property="address" column="address"/>
		<result property="mobile" column="mobile"/>
		<result property="username" column="username"/>
		<result property="password" column="password"/>
		<result property="image" column="image"/>
		<result property="distance" column="distance"/>
		<result property="city_id" column="city_id"/>
		<result property="group_id" column="group_id"/>
		<result property="bank_name" column="bank_name"/>
		<result property="sub_bank_name" column="sub_bank_name"/>
		<result property="bank_no" column="bank_no"/>
		<result property="bank_user" column="bank_user"/>
		<result property="bank_img" column="bank_img"/>
		<result property="bank_province" column="bank_province"/>
		<result property="bank_city" column="bank_city"/>
		<result property="enable" column="enable"/>
		<result property="user_id" column="user_id"/>
		<result property="create_time" column="create_time"/>
		<result property="longlat" column="longlat"/>
		<result property="longi" column="longi"/>
		<result property="lati" column="lati"/>
		<result property="sort_order" column="sort_order"/>
		<result property="fbi" column="fbi"/>
		<result property="qc_id" column="qc_id"/>
		<result property="avatar" column="avatar"/>
		<result property="delivery_fee" column="delivery_fee"/>
		<result property="delivery_begin_money" column="delivery_begin_money"/>
		<result property="delivery_end_money" column="delivery_end_money"/>
		<result property="delivery_days" column="delivery_days"/>
		<result property="delivery_hours" column="delivery_hours"/>
		<result property="sale_time_begin" column="sale_time_begin"/>
		<result property="sale_time_end" column="sale_time_end"/>
		<result property="tohome" column="tohome"/>
		<result property="clear_time" column="clear_time"/>
		<result property="sale" column="sale"/>
		<result property="pv" column="pv"/>
		<result property="uv" column="uv"/>
		<result property="circle_id" column="circle_id"/>
		<result property="area_id" column="area_id"/>
		<result property="service_distance" column="service_distance"/>
		<result property="cartable" column="cartable"/>
		<result property="guarantee_fee" column="guarantee_fee"/>
		<result property="guarantee_flag" column="guarantee_flag"/>
		<result property="balance" column="balance"/>
		<result property="partner_status" column="partner_status"/>
		<result property="close_total_time" column="close_total_time"/>
		<result property="qr_code_url" column="qr_code_url"/>
		<result property="service_mobile" column="service_mobile"/>
		<result property="withdraw_limit_fee" column="withdraw_limit_fee"/>
		<result property="support_shelf" column="support_shelf"/>
		<result property="interval_time" column="interval_time"/>
		<result property="is_top" column="is_top"/>
		<result property="partner_type" column="partner_type"/>
	</resultMap>
	
	<insert id="addPartnerInfo" useGeneratedKeys="true" keyProperty="id" parameterType="org.mybatis.spring.cache.pojo.PartnerInfo">
		insert into partner(title,jieshao,shijian,shijian_begin,shijian_end,address,mobile,username,password,image,distance,city_id,
		group_id,bank_name,sub_bank_name,bank_no,bank_user,bank_img,enable,user_id,create_time,longlat,longi,lati,sort_order,fbi,qc_id,
		avatar,delivery_fee,delivery_begin_money,delivery_end_money,delivery_days,delivery_hours,sale_time_begin,sale_time_end,tohome,
		clear_time,sale,pv,uv,circle_id,area_id,service_distance,cartable,
		balance,guarantee_fee,guarantee_flag,bank_province,bank_city
		,partner_status,close_total_time,qr_code_url,service_mobile,withdraw_limit_fee)
		 values(#{title},#{jieshao},#{shijian},#{shijian_begin},#{shijian_end},#{address},#{mobile},#{username},#{password},#{image},#{distance},#{city_id},
		 #{group_id},#{bank_name},#{sub_bank_name},#{bank_no},#{bank_user},#{bank_img},#{enable},#{user_id},#{create_time},#{longlat},#{longi},#{lati},#{sort_order},#{fbi},#{qc_id},
		 #{avatar},#{delivery_fee},#{delivery_begin_money},#{delivery_end_money},#{delivery_days},#{delivery_hours},#{sale_time_begin},#{sale_time_end},#{tohome},
		 #{clear_time},#{sale},#{pv},#{uv},#{circle_id},#{area_id},#{service_distance},#{cartable},
		 #{balance},#{guarantee_fee},#{guarantee_flag},#{bank_province},#{bank_city}
		 ,#{partner_status},#{close_total_time},#{qr_code_url},#{service_mobile},#{withdraw_limit_fee}
		 )
	</insert>
	
	<select id="getById" resultMap="PartnerInfoResultMap">
		select * from partner where id=#{id}
	</select>
	
	<select id="getFbiPartnerByCityId" resultMap="PartnerInfoResultMap">
		select * from partner where city_id=#{city_id} and fbi =1
	</select>
	
	<select id="getListByFbiAndCityId" resultMap="PartnerInfoResultMap">
		select * from partner where fbi=#{fbi}
		<if test="city_id !=null and city_id !='' ">
			and city_id=#{city_id}
		</if>
		<if test="limit !=null">
			limit #{limit} offset #{offset}
		</if>
	</select>
	
	<select id="getByIdAndIsOpen" resultMap="PartnerInfoResultMap">
		select * from partner where id=#{id} and partner_status = 0
	</select>
	
	<select id="getByIdAndTohome" resultMap="PartnerInfoResultMap">
		select * from partner 
		<where>
			id=#{id} 
			<if test="tohome !=null and tohome !='' ">
				and tohome=#{tohome}
			</if>
		</where>  
	</select>
	
	<select id="getByMobile" resultMap="PartnerInfoResultMap">
		select * from partner where mobile=#{mobile}
	</select>
	
	<select id="getByGroupIdAndCityId" resultMap="PartnerInfoResultMap">
		select * from partner where group_id=#{group_id} and city_id=#{city_id} and partner_status = 0
	</select>
	
	<update id="updateById" parameterType="org.mybatis.spring.cache.pojo.PartnerInfo">
		update partner set title=#{obj.title},jieshao=#{obj.jieshao},shijian=#{obj.shijian},shijian_begin=#{obj.shijian_begin},
		shijian_end=#{obj.shijian_end},address=#{obj.address},mobile=#{obj.mobile},username=#{obj.username},password=#{obj.password},
		image=#{obj.image},distance=#{obj.distance},city_id=#{obj.city_id},group_id=#{obj.group_id},bank_name=#{obj.bank_name},
		sub_bank_name=#{obj.sub_bank_name},bank_no=#{obj.bank_no},bank_user=#{obj.bank_user},bank_img=#{obj.bank_img},
		enable=#{obj.enable},user_id=#{obj.user_id},create_time=#{obj.create_time},longlat=#{obj.longlat},longi=#{obj.longi},
		lati=#{obj.lati},sort_order=#{obj.sort_order},fbi=#{obj.fbi},qc_id=#{obj.qc_id},avatar=#{obj.avatar},
		delivery_fee=#{obj.delivery_fee},delivery_begin_money=#{obj.delivery_begin_money},delivery_end_money=#{obj.delivery_end_money},
		delivery_days=#{obj.delivery_days},delivery_hours=#{obj.delivery_hours},sale_time_begin=#{obj.sale_time_begin},
		sale_time_end=#{obj.sale_time_end},tohome=#{obj.tohome},clear_time=#{obj.clear_time},sale=#{obj.sale},
		pv=#{obj.pv},uv=#{obj.uv},circle_id=#{obj.circle_id},area_id=#{obj.area_id},service_distance=#{obj.service_distance},cartable=#{obj.cartable}
		,balance=#{obj.balance},guarantee_fee=#{obj.guarantee_fee},guarantee_flag=#{obj.guarantee_flag},bank_province=#{obj.bank_province},bank_city=#{obj.bank_city}
		,partner_status=#{obj.partner_status},close_total_time=#{obj.close_total_time},qr_code_url=#{obj.qr_code_url},service_mobile=#{obj.service_mobile}
		,withdraw_limit_fee=#{obj.withdraw_limit_fee},support_shelf=#{obj.support_shelf},interval_time=#{obj.interval_time}
		where id=#{obj.id}
	</update>
	
	<update id="updateBalanceByIdAndDif">
		update partner 
		set balance = balance + #{dif}  
		where id=#{id}
	</update>
	
	<update id="updateBalanceByGuaranteeFee">
		update partner 
		set balance = balance - guarantee_fee, guarantee_flag=1 
		where id=#{id}
	</update>
	
	<delete id="deleteById">
		delete from partner where id=#{id}
	</delete>
	
	<update id="updateCloseTimeAndStatusById">
		update partner
		set close_total_time = close_total_time + #{newCloseTime},partner_status = 0
		where id = #{id}
	</update>
	
	<update id="updateStatusById">
		update partner
		set partner_status = 0
		where id = #{id}
	</update>
	
	<select id="getIds" resultType="long">
		select id from partner
	</select>
	
	<update id="updateUvById">
		update partner
		set uv = #{uv}
		where id = #{id}
	</update>
	
	<update id="updatePvById">
		update partner
		set pv = #{pv}
		where id = #{id}
	</update>
	
	<update id="updateSaleById">
		update partner
		set sale = #{sale}
		where id = #{id}
	</update>
	
	<select id="getCountByCityId" resultType="long">
		select count(1) from partner where city_id = #{city_id}
	</select>
	
	<select id="getListByCityId" resultMap="PartnerInfoResultMap">
		select * from partner where city_id = #{city_id}
		order by id 
		limit #{limit} offset #{offset}
	</select>
</mapper>